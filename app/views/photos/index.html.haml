- title 'Photos'

#photo-modal.modal.text-dark
  .modal-dialog.modal-fullscreen
    .modal-content
      .modal-body
        .modal-header
          %button.btn-close{ type: 'button', data: { bs: { dismiss: 'modal' } } }
        #photo-carousel.carousel.slide{ data: { bs: { interval: false } } }
          .carousel-indicators
            - @photos.each_with_index do |photo, i|
              %button{ type: 'button', class: i.zero? ? 'active' : '', data: { bs: { target: '#photo-carousel', slide_to: i } } }
          .carousel-inner
            - @photos.each_with_index do |photo, i|
              .carousel-item{ class: i.zero? ? 'active' : '' }
                = image_tag photo.image, class: 'd-block w-75'
                .carousel-caption.fs-4= photo.description.to_s.html_safe
          %button.carousel-control-prev{ type: 'button', data: { bs: { target: '#photo-carousel', slide: 'prev' } } }
            %span.carousel-control-prev-icon{ aria: { hidden: true } }
            %span.visually-hidden Previous
          %button.carousel-control-next{ type: 'button', data: { bs: { target: '#photo-carousel', slide: 'next' } } }
            %span.carousel-control-next-icon{ aria: { hidden: true } }
            %span.visually-hidden Next

- content_for :sidebar do

  .row
    %h3.mb-3 Upload Photos
    = form_with model: PhotoBatch.new, html: { multipart: true  } do |f|
      .mb-3
        = f.file_field :images, multiple: true, class: "form-control"
      .mb-3.d-grid
        = f.submit "Save", class: "btn btn-primary"

  %hr

  - if Photo.photo_tag_counts.present?
    .panel.panel-default
      .panel-heading
        %h3.panel-title Tags
      .panel-body
        - tag_cloud(Photo.tag_counts_on(:photo_tags).order(:name), %w(1 2 3 4)) do |tag, frequency|
          = link_to tag.name, photos_path(tag: tag.name), style: "font-size: #{frequency.to_i * 0.5}em"

.row.g-3
  = render @photos

.row
  .col-md-12
    = paginate @photos
