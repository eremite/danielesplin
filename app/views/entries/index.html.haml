%p.pull-right
  %br
  = link_to new_entry_path, class: 'btn btn-success' do
    %i.icon-white.icon-plus
    New Entry

%h1 Entries

.clearfix
  .btn-group.pull-left
    = link_to url_for(starts_at: @starts_at - 1.week), class: 'btn btn-mini' do
      Previous Week
    %a.btn.btn-mini.dropdown-toggle{data: { toggle: 'dropdown' }}
      %span.caret
    %ul.dropdown-menu
      %li= link_to 'Previous Month', url_for(starts_at: @starts_at - 1.month)
      %li= link_to 'Previous Year', url_for(starts_at: @starts_at - 1.year)
  .pull-left
    &nbsp;
    =l @starts_at.to_date
    to
    =l @ends_at.to_date
    &nbsp;
  .btn-group.pull-left
    = link_to url_for(starts_at: @starts_at + 1.week), class: 'btn btn-mini' do
      Next Week
    %a.btn.btn-mini.dropdown-toggle{data: { toggle: 'dropdown' }}
      %span.caret
    %ul.dropdown-menu
      %li= link_to 'Next Month', url_for(starts_at: @starts_at + 1.month)
      %li= link_to 'Next Year', url_for(starts_at: @starts_at + 1.year)

.clearfix
  - if @grouped_entries.empty? && @grouped_photos.empty?
    %p Nothing to show.
  - else
    - (@interval / 1.day).times do |i|
      - today = @starts_at.to_date + i.days
      - @grouped_entries[today].to_a.each do |entry|
        = div_for entry do
          .btn-group.pull-right
            = link_to [:edit, entry], class: 'btn btn-small' do
              %i.icon-edit
              Edit
            = link_to entry, class: 'btn btn-small', method: :delete, confirm: 'Are you sure you want to delete this entry?' do
              %i.icon-trash
              Delete
          %h3=l entry.at, format: :long
          .body
            :markdown
              #{entry.body}
      - if @grouped_entries[today].blank? && @grouped_photos[today].present?
        %h3=l today
      - @grouped_photos[today].to_a.each do |photo|
        - if photo.image?
          = div_for photo do
            = link_to photo.image.url do
              = image_tag photo.image.small.url, class: 'img-polaroid'
